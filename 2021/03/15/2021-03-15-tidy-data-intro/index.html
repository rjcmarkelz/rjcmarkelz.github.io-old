<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Introduction data post with cycling data &#183; Cody Markelz</title><meta name=description content="Cycle Commuting Data For the last few years I commuted to work most days by bicycle along the Martin Luther King Jr. Regional Shoreline Park park in Oakland, CA. This will be a series of data science posts exploring personal data collected by my smart watch and publicly available weather, nature and biodiversity data. It is my hope that this will show into the brain of how a data scientist thinks, learns, asks questions, creates models, and visualizes data from right in their back yard."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.77.0"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Introduction data post with cycling data"><meta property="og:description" content="Cycle Commuting Data For the last few years I commuted to work most days by bicycle along the Martin Luther King Jr. Regional Shoreline Park park in Oakland, CA. This will be a series of data science posts exploring personal data collected by my smart watch and publicly available weather, nature and biodiversity data. It is my hope that this will show into the brain of how a data scientist thinks, learns, asks questions, creates models, and visualizes data from right in their back yard."><meta property="og:type" content="article"><meta property="og:url" content="https://rjcmarkelz.github.io/2021/03/15/2021-03-15-tidy-data-intro/"><link rel=stylesheet href=https://rjcmarkelz.github.io/dist/site.css><link rel=stylesheet href=https://rjcmarkelz.github.io/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous></head><body><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://rjcmarkelz.github.io/>Cody Markelz</a></h1><a class="button-square button-social hint--top" data-hint=Twitter aria-label=Twitter href=https://twitter.com/rjcmarkelz rel=me><i class="fa fa-twitter" aria-hidden=true></i></a><a class="button-square button-social hint--top" data-hint=Github aria-label=Github href=https://github.com/rjcmarkelz rel=me><i class="fa fa-github-alt" aria-hidden=true></i></a><a class="button-square button-social hint--top" data-hint=LinkedIn aria-label=LinkedIn href=https://www.linkedin.com/in/codymarkelz rel=me><i class="fa fa-linkedin" aria-hidden=true></i></a><a class="button-square button-social hint--top" data-hint=Email aria-label="Send an Email" href=mailto:rjcmarkelz@berkeley.edu><i class="fa fa-envelope" aria-hidden=true></i></a></div><ul class=site-nav><li class=site-nav-item><a href=/>Blog</a></li><li class=site-nav-item><a href=/project/>Projects</a></li><li class=site-nav-item><a href=/page/publications/>Publications</a></li><li class=site-nav-item><a href=/page/cv/>CV</a></li><li class=site-nav-item><a href=/page/about/>About</a></li></ul></div></header><div id=container><style>.site-title a,.button-square{background:#000}a{color:#000}</style><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Introduction data post with cycling data</h1><p class=post-date><span>Published <time datetime=2021-03-15 itemprop=datePublished>Mon, Mar 15, 2021</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=# itemprop=url rel=author>Cody Markelz</a></span></span></p><p class="post-reading post-line"><span>Time Committment: 3 min</span></p></header><div class="post-content clearfix" itemprop=articleBody><h1 id=cycle-commuting-data>Cycle Commuting Data</h1><p>For the last few years I commuted to work most days by bicycle along the <a href=https://www.ebparks.org/parks/martinlking/>Martin Luther King Jr. Regional Shoreline Park</a> park in Oakland, CA. This will be a series of data science posts exploring personal data collected by my smart watch and publicly available weather, nature and biodiversity data. It is my hope that this will show into the brain of how a data scientist thinks, learns, asks questions, creates models, and visualizes data from right in their back yard.</p><p>We will be using the tidyverse package today to explore this dataset. Load the package.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>tidyverse</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>lubridate</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>leaflet</span><span class=p>)</span>
</code></pre></div><p>I will do another post on how to make this dataset from an exercise watch at another time.</p><p>Here is the base dataset we will be working with.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=nf>load</span><span class=p>(</span><span class=s>&#34;MLK-park-commute.RData&#34;</span><span class=p>)</span>
</code></pre></div><p>To do some exploratory data analysis, let&rsquo;s visualize some of the dataframe columns to get a feel for what the data represents. First I like to take a look at the data structure and get a feel for the variables.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=nf>ls</span><span class=p>()</span>
<span class=nf>head</span><span class=p>(</span><span class=n>commute</span><span class=p>)</span>
<span class=nf>dim</span><span class=p>(</span><span class=n>commute</span><span class=p>)</span>
<span class=nf>summary</span><span class=p>(</span><span class=n>commute</span><span class=p>)</span>
</code></pre></div><p>Convert the dataframe into a tibble which is a tidyverse dataframe that has some additional properties to make it easier to examine what is going on.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>commute</span> <span class=o>&lt;-</span> <span class=nf>as_tibble</span><span class=p>(</span><span class=n>commute</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>commute</span><span class=p>)</span>
</code></pre></div><p>Passing data around and filtering instead of creating new dataframes for everything is one of the features of tidyverse that I like the best. It is a different way of thinking that becomes more intuitive over time. Below I take the commute tibble pass it to filter to grab a specific single date. filter() then passes the filtered data to leaflet which plots the latitude and longitude data on an Openmaps popup in the browser.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>commute</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=nf>date</span><span class=p>(</span><span class=n>commute</span><span class=o>$</span><span class=n>datetime</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;2018-08-29&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
<span class=nf>leaflet</span><span class=p>()</span> <span class=o>%&gt;%</span> <span class=nf>addTiles</span><span class=p>()</span> <span class=o>%&gt;%</span>
<span class=nf>addPolylines</span><span class=p>(</span><span class=o>~</span><span class=n>lon</span><span class=p>,</span> <span class=o>~</span><span class=n>lat</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;blue&#39;</span><span class=p>,</span> <span class=n>opacity</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>weight</span> <span class=o>=</span> <span class=m>10</span><span class=p>)</span>
</code></pre></div><p><img src=/static/img/MLK-shoreline-commute.png alt=MLK-shoreline-commute></p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>speed_plot</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>commute</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>speed.kmh</span><span class=p>))</span> <span class=o>+</span>
  <span class=nf>geom_histogram</span><span class=p>()</span>
<span class=n>speed_plot</span>
<span class=nf>ggsave</span><span class=p>(</span><span class=s>&#34;speed-commute-plot.png&#34;</span><span class=p>)</span>
</code></pre></div><p><img src=/static/img/speed-commute-plot.png alt=image></p><p>The watch that I have has the ability to detect heart rate and it works fairly well if your wrist is not moving around compared to the much more accurate heart rate strap. Here I create a new column of data that breaks up the heart rate information into different zones roughly corresponding to different physiological states. These zones are defined by</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>commute</span><span class=o>$</span><span class=n>HRzone</span> <span class=o>&lt;-</span> <span class=nf>cut</span><span class=p>(</span><span class=n>commute</span><span class=o>$</span><span class=n>hr.bpm</span><span class=p>,</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>105</span><span class=p>,</span> <span class=m>150</span><span class=p>,</span> <span class=m>160</span><span class=p>,</span> <span class=m>174</span><span class=p>,</span> <span class=m>188</span><span class=p>,</span> <span class=m>200</span><span class=p>))</span>
<span class=nf>levels</span><span class=p>(</span><span class=n>commute</span><span class=o>$</span><span class=n>HRzone</span><span class=p>)</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;R&#34;</span><span class=p>,</span><span class=s>&#34;Z1&#34;</span><span class=p>,</span><span class=s>&#34;Z2&#34;</span><span class=p>,</span><span class=s>&#34;Z3&#34;</span><span class=p>,</span><span class=s>&#34;Z4&#34;</span><span class=p>,</span><span class=s>&#34;Z5&#34;</span><span class=p>)</span>
</code></pre></div><p>Let&rsquo;s take a look at the heart rate data. First plotting a histogram.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>bpm_plot</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>commute</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>hr.bpm</span><span class=p>))</span> <span class=o>+</span>
  <span class=nf>geom_histogram</span><span class=p>()</span>
<span class=n>bpm_plot</span>
<span class=nf>ggsave</span><span class=p>(</span><span class=s>&#34;heart-rate-commute-bpm_plot.png&#34;</span><span class=p>)</span>
</code></pre></div><p><img src=/static/img/heart-rate-commute-bpm_plot.png alt=image></p><p>Let&rsquo;s add the heart rate zone information as color and then do some axis labeling and clean up.</p><div class=highlight><pre class=chroma><code class=language-R data-lang=R><span class=n>bpm_plot2</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>commute</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>hr.bpm</span><span class=p>,</span> <span class=n>fill</span> <span class=o>=</span> <span class=n>HRzone</span><span class=p>))</span> <span class=o>+</span>
       <span class=nf>geom_histogram</span><span class=p>()</span> <span class=o>+</span>
       <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s>&#34;Heart Rate (Beats Per Minute)&#34;</span><span class=p>,</span> <span class=n>limits</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>200</span><span class=p>))</span> <span class=o>+</span>
       <span class=nf>scale_y_continuous</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s>&#34;Count&#34;</span><span class=p>,</span> <span class=n>limits</span><span class=o>=</span><span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>80000</span><span class=p>))</span>
<span class=n>bpm_plot2</span>
<span class=nf>ggsave</span><span class=p>(</span><span class=s>&#34;heart-rate-commute-bpm_plot2.png&#34;</span><span class=p>)</span>
</code></pre></div><p><img src=/static/img/heart-rate-commute-bpm_plot2.png alt=image></p><p>You can see in the figure above that I spent most of my commuting time in low Z1 or the recovery heart rate zone. It was harder to do Z1-Z3 workouts on the commuting bike because I often had to go directly into meetings after a quick shower, or there were many people along walking along the shore preventing me from going faster. This was frustrating at first, but I grew to love the slower pace and over the few years got to witness some amazing tidal changes, bird migrations, wildflower blooms, sunrises and sunsets along the MLK shoreline. More on the natural history of the area in the subsequent posts.</p></div><footer class="post-footer clearfix"><div class=share><a class=icon-twitter href="https://twitter.com/share?text=Introduction%20data%20post%20with%20cycling%20data&url=https%3a%2f%2frjcmarkelz.github.io%2f2021%2f03%2f15%2f2021-03-15-tidy-data-intro%2f" onclick="window.open(this.href,'twitter-share','width=550,height=235');return false;" aria-label="Share on Twitter"><i class="fa fa-twitter" aria-hidden=true></i></a><a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2frjcmarkelz.github.io%2f2021%2f03%2f15%2f2021-03-15-tidy-data-intro%2f" onclick="window.open(this.href,'facebook-share','width=580,height=296');return false;" aria-label="Share on Facebook"><i class="fa fa-facebook" aria-hidden=true></i></a></div></footer></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=https://rjcmarkelz.github.io/>Cody Markelz</a></h1><a class="button-square button-jump-top js-jump-top" href=# aria-label="Back to Top"><i class="fa fa-angle-up" aria-hidden=true></i></a></div><p class=footer-copyright><span>&copy; 2021 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p><p class=footer-copyright></p></div></footer><script src=https://rjcmarkelz.github.io/js/jquery-1.11.3.min.js></script><script src=https://rjcmarkelz.github.io/js/jquery.fitvids.js></script><script src=https://rjcmarkelz.github.io/js/scripts.js></script></body></html>